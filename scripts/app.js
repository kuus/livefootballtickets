/* global jQuery, Bloodhound */
/* jshint devel:true, unused: false */
/*!
 * LiveFootballTickets v0.0.1 (http://livefootballtickets.com)
 * Buy tickets for games in England and European leagues online. All football ticket orders are guaranteed.
 *
 * by kuus <kunderikuus@gmail.com> (http://kunderikuus.net/)
 * Copyright (C) kunderi kuus, Inc - All Rights Reserved 2015-2016
 */
!function(e,t,a){"use strict";function n(e,t){var a,n=t||200;return function(){var t=this,i=arguments;clearTimeout(a),a=setTimeout(function(){e.apply(t,Array.prototype.slice.call(i))},n)}}function i(){var e=a(".readmore");e.readmore({speed:180,moreLink:'<div class="readmore-toggle"><a href="#">Read more</a> <i class="icon icon-angle-down"></i></div>',lessLink:'<div class="readmore-toggle"><a href="#">Close</a> <i class="icon icon-angle-up"></i></div>',afterToggle:function(e,t,n){a(t).toggleClass("expanded",n)}})}function o(){a.notifyDefaults({newest_on_top:!0,autoHide:!1,placement:{from:"bottom",align:"right"},animate:{delay:2e3,enter:"animated zoomInDown",exit:"animated zoomOutUp"},spacing:60})}function s(t){var n=a("#search-main"),i=location.protocol+"//"+location.hostname+"/pages/ajax/callbacks.aspx/suggestion#%QUERY",o="/search?q=",s=e.LTF_URL_SEARCH||i;(t||e.LTF_MOCKED_API)&&(s="/data/search.json",t=!0);var r=function(e,a,n){return new Bloodhound({initalize:!1,datumTokenizer:Bloodhound.tokenizers.obj.whitespace(e),queryTokenizer:Bloodhound.tokenizers.whitespace,remote:{url:s,wildcard:t?"":"%QUERY",prepare:function(e,a){return t?a:(a.type="POST",a.contentType="application/json; charset=UTF-8",a.data=JSON.stringify({q:e}),a)},filter:function(e){return t||(e=JSON.parse(e.d)),n?e.more?[!0]:[]:e.result[a]}}})},l=r("name","events"),c=r("name","categories"),d=r("name","teams"),u=r("name","stadiums"),h=r("name","cities"),m=r(null,null,!0);n.typeahead({highlight:!0},{name:"events",display:"name",limit:3,source:l.ttAdapter(),templates:{header:'<h3 class="tt-header">Events</h3>',suggestion:function(e){return'<a href="'+e.url+'" data-id="'+e.id+'">'+e.name+'<span class="tt__subhint tt__date">'+e.date+"</span></a>"}}},{name:"categories",display:"name",limit:3,source:c.ttAdapter(),templates:{header:'<h3 class="tt-header">Categories</h3>',suggestion:function(e){return'<a href="'+e.url+'" data-id="'+e.id+'">'+e.name+"</a>"}}},{name:"teams",display:"name",limit:3,source:d.ttAdapter(),templates:{header:'<h3 class="tt-header">Teams</h3>',suggestion:function(e){return'<a href="'+e.url+'" data-id="'+e.id+'">'+e.name+"</a>"}}},{name:"stadiums",display:"name",limit:3,source:u.ttAdapter(),templates:{header:'<h3 class="tt-header">Stadiums</h3>',suggestion:function(e){return'<a href="'+e.url+'" data-id="'+e.id+'">'+e.name+"</a>"}}},{name:"cities",display:"name",limit:3,source:h.ttAdapter(),templates:{header:'<h3 class="tt-header">Cities</h3>',suggestion:function(e){return'<a href="'+e.url+'" data-id="'+e.id+'">'+e.name+"</a>"}}},{name:"more",display:"name",limit:3,source:m.ttAdapter(),templates:{footer:function(e){var t=o+e.query;return'<a href="'+t+'" class="tt__footer">View all results for <strong>\''+e.query+"'</strong></a>"},suggestion:function(){return"<i></i>"}}}).on("typeahead:asyncrequest",function(){n.addClass("tt-loading")}).on("typeahead:asyncreceive",function(){n.removeClass("tt-loading")}).on("typeahead:selected",function(t,a){a.url&&(e.location.href=a.url)})}function r(){var t=a("#header-slider-main"),n=a("#header-slider-placeholder"),i=a("#header-slider-nav-wrap"),o=i.find("li");t.slick({arrows:!1}).fadeIn(),i.fadeIn(),n.hide(),a(e).resize(),o.on("mouseenter",function(){var e=a(this);t.slick("slickGoTo",e.index(),!1),o.removeClass("active"),e.addClass("active")})}function l(){var t="welcomeMobile",n=a("#modal-welcome"),i=a("#modal-welcome-btn-continue"),o=a.cookie(t);!o&&e.innerWidth<992&&(n.modal().on("shown.bs.modal",function(){a.cookie(t,"1",{expires:365,path:"/"})}).on("hide.bs.modal",function(){}),i.click(function(){})),a(".modal-remote").click(function(e){var t=this,n=a(t.getAttribute("data-modal")),i=n.find(".modal-body");n.on("show.bs.modal",function(){i.load(t.href)}).modal(),e.preventDefault()})}function c(){a(".event-list-item").on("click",function(e){if(!a(e.target).is("a")){var n=a(this),i=n.find("a.btn")[0];i&&(t.location.href=i.href)}})}function d(){a(".tip").tooltip({container:"body"})}function u(){var i=a(e),o=a("body"),s=e.innerWidth,r=i.scrollTop(),l=a("#why-book-with-us"),c=a("#about"),d=a(".header-top"),u=d.outerHeight(),h=a(".header-middle"),m=!1,f=!1,p=a("#col-tickets"),g=a("#col-stadium"),v=t.getElementById("stadium-img"),y=!1,w=a("#tickets-list"),b=a("#navbar").find(".dropdown-menu"),k=function(){h.addClass("sticky-header").clone().addClass("sticky-header-clone").insertAfter(h),m=!0},T=function(){r>=u&&s>=992&&!f&&(m||k(),o.addClass("sticky-header-on"),f=!0),(r<u&&f||s<992&&f)&&(o.removeClass("sticky-header-on"),f=!1)};s>=992&&k();var C=function(){s>=768&&s<992?c.css("min-height",l.outerHeight()):c.css("min-height",0)},_=function(){if(p.length&&g.length&&w.length)if(v&&v.src&&!y){var e=new Image;e.src=v.src,e.onload=x,y=!0}else x(),y=!0},x=function(){if(s>=992){var e=g.outerHeight(),t=e-90;w.css({"max-height":t})}else w.css({"max-height":"none"})},A=function(){s>=768?b.css({"max-height":e.innerHeight-h.outerHeight()-20,overflow:"auto"}):b.css({"max-height":"none",overflow:"auto"})};i.scroll(function(){r=i.scrollTop(),T()}),i.resize(function(){s=e.innerWidth,C(),T(),A()}),i.resize(n(function(){_()})),C(),_(),T(),A()}function h(){a(".newsletter .help-block").hide();var e=!1,t=/^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/,n=a("#ctl00_ucEmailSubscription_UserEmail").val();if(""===n||"enter your email"===n?(a(".newsletter .input-group").after('<div class="help-block">This field can not be empty</div>'),e=!0):t.test(n)||(a(".newsletter #input-group").after('<div class="help-block">Enter a valid email address.</span>'),e=!0),e)return a(".newsletter .input-group").addClass("has-error"),!1;var i="{email:'"+n+"'}";a.ajax({type:"POST",url:location.protocol+"//"+location.hostname+"/pages/ajax/callbacks.aspx/emailsubscription",data:i,beforeSend:function(e){e.setRequestHeader("Content-type","application/json; charset=utf-8")},contentType:"application/json; charset=utf-8",dataType:"json",success:function(e,t){a(".newsletter .input-group").after('<div class="help-block">'+e.d+"</span>")},error:function(e,t,a){}})}a(t).ready(function(){u(),i(),o(),s(),r(),l(),c(),d(),a("#emailSubscribtion").click(h)})}(window,document,jQuery);